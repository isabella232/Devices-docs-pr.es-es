---
title: Administrar Surface Dock 2 con WMI
description: En este artículo se explica cómo usar WMI para supervisar y administrar de forma remota el firmware, el estado de directiva y los datos relacionados más recientes en dispositivos Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
appliesto:
- Windows 10
- Windows 11
ms.openlocfilehash: 658632220dfa87aa88fa233a7d55c311042a91cc
ms.sourcegitcommit: beb2f9db90b19b74da6cdee8717cc0888f3b1d70
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/16/2022
ms.locfileid: "12448903"
---
# <a name="manage-surface-dock-2-with-wmi"></a>Administrar Surface Dock 2 con WMI

Windows de instrumental de administración (WMI) proporciona un amplio conjunto de información de diagnóstico que permite a los administradores de TI supervisar y administrar de forma remota el firmware, el estado de directiva y los datos relacionados más recientes en dispositivos Surface Dock 2. Puede usar WMI con Windows PowerShell, System Center Operations Manager y otras herramientas. Para obtener más información acerca de WMI, vea [Trabajar con WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Para habilitar la compatibilidad con WMI, ve a [Controladores y firmware de Surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) y descarga el paquete adecuado:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versión&#62;_x64.msi:**<br>

- Surface Pro (5ª generación y posterior)
- Surface Book (2nd Gen y versiones posteriores)
- Surface Go (todas las generaciones)
- Surface Laptop (todas las generaciones)
- Surface Laptop Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versión&#62;_arm64.msi:** <br>

- Surface Pro X

## <a name="using-wmi-with-surface-dock-2"></a>Uso de WMI con Surface Dock 2

1. Para enumerar todas las instancias de componentes de acoplamiento:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Para obtener acceso a las descripciones de propiedades de clase WMI, abra un símbolo del sistema y escriba comandos WMI donde **Property** es una de las propiedades enumeradas en la tabla 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Ejemplo:** Para obtener acceso a la descripción de **la propiedad Version** Common Information Model (CIM), escriba lo siguiente:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### <a name="table-1-surface-dock-2-wmi-reference"></a>Tabla 1. Referencia wmi de Surface Dock 2

| Propiedad         | Tipo   | Valor(s) esperado(s)                                                                                                                                                                                                            | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Cadena | "Microcontrolador" <br>"Concentrador USB 1" <br>"Concentrador USB 2" <br>"Display Port Hub" <br>"Controlador de entrega de energía" <br>"Códec de audio" <br>"Controlador Ethernet"                                                                         | La siguiente propiedad enumera el nombre específico del componente de dispositivo al que corresponden los datos de clase del modelo de información común (CIM) adjuntos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Propiedad DeviceName       | Cadena | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | La siguiente propiedad contiene el nombre del dispositivo de acoplamiento al que pertenece el componente de dispositivo específico.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Cadena | Un número de serie de doce (12) dígitos que solo contiene valores numéricos                                                                                                                                                           | La siguiente propiedad registra el número de serie del dispositivo de acoplamiento adjunto. Este número de serie es exactamente el mismo para todos los componentes que pertenecen al mismo dispositivo de acoplamiento. Como referencia, este número de serie se puede encontrar físicamente en la parte inferior del propio Surface Dock.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | uint16 | 0, 1, 2, ..., 65535                                                                                                                                                                                                          | La siguiente propiedad es un identificador único que comienza a partir de cero (0) y cuenta hacia arriba. Esta variable se usa para numerar las instancias DE WMI enumeradas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Cadena | "Éxito" <br>"PendingDockReattach" <br>"Error"                                                                                                                                                                             | La siguiente propiedad detalla el último intento de actualización de firmware de componentes (CFU) para el componente de dispositivo en cuestión. Los valores posibles son: **Success,** **Pending Dock Reattach y** **Failed.**<br><br><br>- **El** éxito indica que el nuevo firmware aplicado anteriormente se aplicó correctamente<br>- **Pending Dock Reattach** indica que hay una nueva actualización pendiente para el componente del dispositivo y el usuario debe desasocie y volver a conectar el conector de Surface del Dock para aplicar la nueva actualización.<br>- **Error** indica que se ha producido un posible error legítimo durante el proceso CFU o que el periférico no se ha arrancado en la versión esperada. En el **caso de error** , esto no es una indicación de que el dispositivo no funciona, sino que se produjo algo erróneo al intentar actualizar el dispositivo. En tal caso, el firmware anterior seguirá en ejecución.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Cadena | "Habilitado" <br>"Deshabilitado"                                                                                                                                                                                                     | La siguiente propiedad indica la directiva actual Enterprise modo de administración de Surface (SEMM) para el componente del dispositivo. Los valores posibles son: **Habilitado** y **Deshabilitado.**<br><br><br>- **Enabled** indica que el sistema SEMM ha permitido al dispositivo host acceder y usar el componente de dispositivo<br>- **Disabled** indica que el sistema SEMM no ha permitido y, por lo tanto, ha impedido que el equipo host acceda y use el componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String[] | Una lista de cadenas hexadecimales, que pueden variar de "0x0000" a "0xFFFF"                                                                                                                                                        | La siguiente propiedad clasifica el Id. de producto (PID) del componente de dispositivo. Es posible que haya más de un PID en la lista. En el caso de un concentrador USB, por ejemplo, los dispositivos Super Speed (SS) y High Speed (HS) se agrupan en un "Hub" singular. Por lo tanto, dos (2) PIDs se enumeran dentro de esta matriz.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | booleano | True o False                                                                                                                                                        | La siguiente propiedad describe el estado aprovisionado Enterprise modo de administración de Surface (SEMM) del dispositivo Surface Dock. El estado aprovisionado es exactamente el mismo para todos los componentes que pertenecen al mismo dispositivo de acoplamiento. Los valores posibles son: True o False. Un valor true indica que el dispositivo Surface Dock está administrado actualmente y, por lo tanto, la funcionalidad de puerto puede estar restringida. Vea el campo de la propiedad "PolicyState" para obtener más información. Un valor de false indica que el dispositivo Surface Dock no está administrado actualmente y no tiene restricciones de características impuestas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Estado           | Cadena | "Aceptar" <br>"Desconectado" <br>"Error" <br>"Falta" <br>"DeviceHandleInUse" <br>"Deshabilitado" <br>"NotSupportedByWmi"                                                                                                             | La siguiente propiedad describe el estado de la conexión del Dock con el equipo host. Los valores posibles son: **Ok,** **Disconnected,** **Error,** **Missing,** **DeviceHandleInUse,Disabled** **y** **NotSupportedByWmi.**   <br>- **Ok** indica que el dispositivo se ha conectado correctamente al equipo host y que no existen problemas, lo que inhibiría su funcionalidad. <br>- **Disconnected** indica que el conector de Surface, que proporciona la conexión para todos los componentes del dispositivo, no está conectado actualmente al equipo host. <br>- **Error** indica un posible problema con la instancia del dispositivo y es más probable que la interfaz del dispositivo se haya etiquetado con un signo de exclamación amarillo en el Administrador de dispositivos: compruebe la propiedad **StatusCode** para obtener información más detallada sobre el tipo de error que se produjo. <br>- **Falta** indica que se esperaba que el dispositivo se enumerara en el equipo host, pero por algún motivo no lo hizo. La **propiedad StatusCode** tendrá el valor 24 para indicar esta situación errónea.<br>- **DeviceHandleInUse** indica que otro proceso se está comunicando actualmente con el dispositivo, lo que prohíbe a este proveedor de instancias de instrumental de administración de Windows (WMI) sus solicitudes de comunicación. Intente volver a ejecutar el comando WMI. <br> - **Disabled** indica que la directiva actual del modo de administración de Surface Enterprise (SEMM) no se ha permitido y, por lo tanto, ha impedido que el equipo host acceda y use el componente del dispositivo. Vea el **campo de la propiedad PolicyState** para obtener más información.<br>- **NotSupportedByWmi** indica que el dock conectado actualmente no es compatible con este proveedor WMI. Este estado aparecerá para Surface Dock 1, que actualmente no es compatible con este proveedor de instancias wmi.|
| StatusCode       | uint32 | [Código de error del Administrador](/windows-hardware/drivers/install/device-manager-error-messages) de dispositivos obtenido CIM_LogicalDevice clase WMI (dentro de *cimwin32.mof*) | La siguiente propiedad proporciona el código de error del Administrador de dispositivos para el componente de acoplamiento determinado. Un valor de cero (0) indica que el componente de acoplamiento funciona correctamente; un valor mayor que cero (0) indica un problema o un posible error con el componente de acoplamiento. Dado que el componente de acoplamiento puede enumerarse con varias interfaces de dispositivo, es posible que haya códigos de error adicionales del Administrador de dispositivos. Este campo de propiedad solo enumera un código de error único incluso si hay varios disponibles. El Administrador de dispositivos etiquetará el dispositivo con un signo de exclamación amarillo solo cuando se han producido ciertos códigos de error.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | Cadena | Una cadena hexadecimal que puede variar de "0x0000" a "0xFFFF"                                                                                                                                                                        | La siguiente propiedad indica el identificador de proveedor (VID) específico del componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Versión          | Cadena | Una cadena de versión, que tiene el formato siguiente: "x.y.z", donde x, y y z son valores numéricos.                                                                                                                            | La siguiente propiedad especifica la versión actual del firmware, que se está ejecutando actualmente en el componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## <a name="learn-more"></a>Obtén más información

- [Proteger puertos de Surface Dock 2 con SEMM](secure-surface-dock-ports-semm.md)
- [Novedades de Surface Dock 2](surface-dock-whats-new.md)
- [Códigos de error del Administrador de dispositivos](/windows-hardware/drivers/install/device-manager-error-messages)
- [Trabajar con WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
